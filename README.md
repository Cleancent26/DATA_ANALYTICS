# DEFORESTATION AMONG COUNTRIES AND THEIR INCOME_GROUPS (1990-2016) - AN SQL PROJECT.
#### DATA ASSESSMENT AND CLEANING.

#### EFFECTING CHANGES TO COUNTRY NAME FROM 'BAHAMAS, THE' TO 'THE BAHAMAS' AND'GAMBIA, THE' TO 'THE GAMBIA'
```
UPDATE FOREST_AREA SET COUNTRY_NAME = 
CASE 
	WHEN COUNTRY_NAME = 'BAHAMAS, THE' THEN 'The Bahamas'
	WHEN COUNTRY_NAME = 'GAMBIA, THE' THEN 'The Gambia'
else country_name
END;
```
#### CHANGING OF COUNTRY_NAME FROM 'CABO VERDE' TO 'Cape Verde'
```
UPDATE FOREST_AREA 
SET COUNTRY_NAME = 'Cape Verde'
WHERE COUNTRY_NAME =
(SELECT DISTINCT COUNTRY_NAME FROM FOREST_AREA
WHERE COUNTRY_NAME = 'CABO VERDE'
);
```
#### COUNTRIES WITH  NULL VALUES IN THE FOREST_AREA_SQKM COLUMN FOR THE ENTIRE SCOPE(1989-2016)  USING SUBQUERY 
```
SELECT COUNTRY_NAME FROM 
(SELECT DISTINCT COUNTRY_NAME,YEAR, 
DENSE_RANK() OVER(PARTITION BY COUNTRY_NAME ORDER BY YEAR DESC ) Y FROM Forest_Area
WHERE forest_area_sqkm IS NULL AND YEAR >= 1989  ) W 
WHERE Y = 27
;
```
#### DELETED COUNTRIES WITH  NULL VALUES IN THE FOREST_AREA_SQKM COLUMN FOR THE ENTIRE SCOPE(1989-2016)  USING SUBQUERY 
```
DELETE FROM Forest_Area WHERE country_name IN 
(SELECT COUNTRY_NAME FROM 
(SELECT DISTINCT COUNTRY_NAME,YEAR, 
DENSE_RANK() OVER(PARTITION BY COUNTRY_NAME ORDER BY YEAR DESC ) Y FROM Forest_Area
WHERE forest_area_sqkm IS NULL AND YEAR >= 1989  ) W 
WHERE Y = 27)
;
```
#### DELETED COUNTRIES WHERE 21 OUT OF THE 27 forest_area_sqkm IS NULL
 ```
DELETE FROM Forest_Area WHERE forest_area_sqkm IS NULL AND country_name  IN 
 (SELECT COUNTRY_NAME FROM
 (SELECT DISTINCT country_name,YEAR,
 DENSE_RANK() OVER(PARTITION BY COUNTRY_NAME ORDER BY YEAR DESC) U FROM FOREST_AREA
 WHERE forest_area_sqkm IS NULL) H 
 WHERE U =  21)
;
```
####  DELETED COUNTRIES WHERE 21 OUT OF THE 27 forest_area_sqkm IS NULL
 ```
DELETE FROM Forest_Area WHERE country_name  =
 (SELECT COUNTRY_NAME FROM
 (SELECT DISTINCT country_name,YEAR,
 DENSE_RANK() OVER(PARTITION BY COUNTRY_NAME ORDER BY YEAR DESC) U FROM FOREST_AREA
 WHERE forest_area_sqkm IS NULL) H 
 WHERE U =  21)
;
```
#### DELETED COUNTRIES WITH ONLY 6 OUT OF THE 27 forest_area_sqkm THAT IS NOT NULL i.e SUDAN 
```
DELETE FROM Forest_Area WHERE COUNTRY_NAME =
 (SELECT DISTINCT country_name FROM Forest_Area
  WHERE  country_name =  'SUDAN'  )
;
```
#### DELETED COUNTRIES WITH ONLY 6 OUT OF THE 27 forest_area_sqkm THAT IS NOT NULL i.e SOUTH SUDAN
```
DELETE FROM Forest_Area WHERE COUNTRY_NAME =
 (SELECT DISTINCT country_name FROM Forest_Area
  WHERE  country_name =  'SOUTH SUDAN'  )
;
```





##### Find full project [here](https://github.com/Cleancent26/DATA_ANALYTICS/blob/main/DEFORESTATION_AMONG_COUNTRIES.sql)


